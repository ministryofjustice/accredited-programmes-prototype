{% extends "layouts/main.html" %}

{% block pageTitle %}
Referral to Building Choices: moderate intensity - {{ serviceName }} - GOV.UK Prototype Kit
{% endblock %}

{% block header %}
{% include "/includes/community/e2e/header-pop-no-primary-nav.html" %}
{% include "/includes/community/e2e/header-pop-sub-nav-referral-details.html" %}
{% endblock %}

{% block content %}
<div class="govuk-grid-row clear">
    <div class="govuk-grid-column-full">
		<div class="moj-page-header-actions">
			<div class="moj-page-header-actions__title">
	  			<h1 class="govuk-heading-xl">Status history</h1>
			</div>
			<div class="moj-button-group moj-button-group--inline govuk-!-margin-top-6">
				<div class="moj-button-menu" data-module="moj-button-menu" data-button-text="Update referral" data-button-classes="govuk-button--secondary">
					<a href="change-referral-status" role="button" draggable="false" class="govuk-button moj-button-menu__item govuk-button--secondary" data-module="govuk-button">Update status</a>
					<a href="change-ldc-status" role="button" draggable="false" class="govuk-button moj-button-menu__item govuk-button--secondary" data-module="govuk-button">Change LDC status</a>
					<a href="change-cohort" role="button" draggable="false" class="govuk-button moj-button-menu__item govuk-button--secondary" data-module="govuk-button">Change cohort</a>		  
				</div>
			</div>
 		</div>
	</div>
</div>
 	

<div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">

		<!-- Referral status - conditional formatting for showing a success banner -->
		{% if showBanner %}
		<div role="region" class="moj-alert moj-alert--success" aria-label="success: Person removed successfully" data-module="moj-alert" data-dismissible="true">
			<div>
			  	<svg class="moj-alert__icon" role="presentation" focusable="false" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 30 30" height="30" width="30">
					<path d="M11.2869 24.6726L2.00415 15.3899L4.62189 12.7722L11.2869 19.4186L25.3781 5.32739L27.9958 7.96369L11.2869 24.6726Z" fill="currentColor" />
			  	</svg>
			</div>
			<div class="moj-alert__content">
			<h2 class="moj-alert__heading">Referral status updated</h2>
				{% if data['choose-referral-status'] == "awaiting-allocation" %}
					Alex River’s referral status is now Awaiting allocation.
				{% elseif data['choose-referral-status'] == "suitable-but-not-ready" %}
					Alex River’s referral status is now Suitable but not ready.
				{% elseif data['choose-referral-status'] == "deprioritised" %}
					Alex River’s referral status is now Deprioritised.
				{% elseif data['choose-referral-status'] == "recall" %}
					Alex River’s referral status is now Recall.
				{% elseif data['choose-referral-status'] == "return-to-court" %}
					Alex River’s referral status is now Return to court.
				{% else %}
					Alex River’s referral status is now On programme.
				{% endif %}
			</div>
			<div class="moj-alert__action">
			  <button class="moj-alert__dismiss" hidden>Dismiss</button>
			</div>
		</div>
		{% endif %}

		<div class="moj-timeline">
			<div class="moj-timeline__item">
				<div class="moj-timeline__header">
					<h2 class="moj-timeline__title">Status update</h2>
					<p class="moj-timeline__byline">by You</p>
			  	</div>
			  	<p class="moj-timeline__date">
					<time datetime="2023-06-29T16:12:00.000Z">2 September 2025 at 4:12pm</time>
			  	</p>
			  	<div class="moj-timeline__description">
					{% if data['choose-referral-status'] == "awaiting-allocation" %}
						<strong class="govuk-tag govuk-tag--light-blue">Awaiting allocation</strong>
					{% elseif data['choose-referral-status'] == "suitable-but-not-ready" %}
						<strong class="govuk-tag govuk-tag--yellow">Suitable but not ready</strong>
					{% elseif data['choose-referral-status'] == "deprioritised" %}
						<strong class="govuk-tag govuk-tag--yellow">Deprioritised</strong>
					{% elseif data['choose-referral-status'] == "recall" %}
						<strong class="govuk-tag govuk-tag--orange">Recall</strong>
					{% elseif data['choose-referral-status'] == "return-to-court" %}
						<strong class="govuk-tag govuk-tag--orange">Return to court</strong>
					{% else %}
						<strong class="govuk-tag govuk-tag--green">On programme</strong>
					{% endif %}
					{% if data['referral-status-details'] %}
						<p class="govuk-body govuk-!-margin-top-4"><strong>Details:</strong> {{ data['referral-status-details'] }}</p>
					{% endif %}
			  	</div>
			</div> 
			<div class="moj-timeline__item">
				<div class="moj-timeline__header">
					<h2 class="moj-timeline__title">Status update</h2>
					<p class="moj-timeline__byline">by Berta Tonka</p>
			  	</div>
			  	<p class="moj-timeline__date">
					<time datetime="2023-06-28T10:00:00.000Z">29 August 2025 at 10:00am</time>
			  	</p>
			  	<div class="moj-timeline__description">
					<strong class="govuk-tag govuk-tag--purple">Awaiting assessment</strong>
			  	</div>
			</div> 
		</div>
    </div>
</div>
{% endblock %}
